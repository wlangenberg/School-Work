library(tidyverse)


red_wine_df <- read.csv2("Data/winequality-red.csv")
white_wine_df <- read.csv2("Data/winequality-white.csv")
combined_df <- rbind(red_wine_df, white_wine_df)
combined_df_num <- as.data.frame(apply(combined_df, 2, FUN = as.numeric))

#Shuffling the data
shuffled_df <- combined_df_num[sample(nrow(combined_df)), ]

smp_size <- floor(0.80 * nrow(shuffled_df))
set.seed(9907)
train_ind <- sample(seq_len(nrow(shuffled_df)), size = smp_size)
training_df <- shuffled_df[train_ind, ]
testing_df <- shuffled_df[-train_ind, ]
  
model <- glm(quality ~., data=as.data.frame(training_df))
preds <- predict(model, testing_df)

#Accuracy...
sum(as.integer(round(preds, 0)) == testing_df$quality)/length(testing_df$quality)
