---
title: "Case Study 1"
author: "Willie Langenberg"
date: '2021-01-14'
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Exercise 1

We are given data generated by an AR model. We are then supposed to find the number of lags used in the model, and it's parameters. An important note is that the lags is not above 5. This is essentially _order determination_, so to find the number of lags one must calculate the AIC for models with 1, 2, 3, 4 and 5 number of lags, and choose the one with lowest AIC. 

```{r}
# Read the data
AR_df <- scan("AR.txt")

# Fit the data to an AR model with max 5 lags.
model <- ar(AR_df, AIC=TRUE, method="mle", order.max = 5)

# The function "ar" automatically fits the best model according to it's AIC. 
# We now want to see what amount of lags it used in the model.
model_ord <- model$order

# Parameters of the model
coeff <- model$ar
```
The best amount of lags to use according to AIC is then `r model_ord`. The parameters in the fitted AR(3) model is `r coeff`.


\newpage
## Exercise 2

Given the data for U.S. quarterly real gross domestic product from 1947 to 2010, we are now going to test the null hypothesis 
$$H_0 : \rho_1 = \rho_2 = \dotsc = \rho_{12} = 0 $$ 
against the alternative hypothesis 
$$H_1 : \rho_i \neq 0 \textrm{ for some } i \in \{ 1,\dotsc,12 \}.$$
We do this by using the Ljung-Box test. The test statistic is given by 
$$Q = n(n+2)\sum_{k=1}^h \frac{\hat{\rho}_k^2}{n-k},$$ 
where $n$ is the number of observations, $\hat{\rho}$ is the autocorrelation at lag $k$, and $h$ is the number of lags being tested. Under the null hypotheis, $Q$ asymptotically follows a $\chi^2(h)$ distribution.

```{r, echo=FALSE}
# Read the data
gdp_df = read.table("GDP.txt",header=T) 
gdp <- gdp_df$gdp
# log(gdp)
log_gdp <- log(gdp)

#growth rate, first difference series of log(gdp)
growth_rate <- diff(log_gdp)

# Ljung-Box statistic Q(12)
Box.test(growth_rate, lag=12, type='Ljung') 
```

With our data the $Q$ statistic is $62.848$. The p-value of the test is very small (<0.0001%), so we can safely reject the null hypothesis. This suggests that the quarterly growth rate of the GDP is serially correlated. 


```{r}
# Simple AR model ->
model2 <- ar(growth_rate, AIC=TRUE, method="mle", order.max = 5)
model2

# Perform model checking to justify your model ->

```
###  ###

Interpret the results!

Build a suitable AR model, and perform model checking.

### ###


## Exercise 3

```{r}


```

### Exercise 3.1


### Exercise 3.2

